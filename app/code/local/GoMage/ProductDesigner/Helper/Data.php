<?php eval(base64_decode("LyoqICogR29NYWdlIFByb2R1Y3QgRGVzaWduZXIgRXh0ZW5zaW9uICogKiBAY2F0ZWdvcnkgRXh0ZW5zaW9uICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTMtMjAxNSBHb01hZ2UgKGh0dHA6Ly93d3cuZ29tYWdlLmNvbSkgKiBAYXV0aG9yIEdvTWFnZSAqIEBsaWNlbnNlIGh0dHA6Ly93d3cuZ29tYWdlLmNvbS9saWNlbnNlLWFncmVlbWVudC8gU2luZ2xlIGRvbWFpbiBsaWNlbnNlICogQHRlcm1zIG9mIHVzZSBodHRwOi8vd3d3LmdvbWFnZS5jb20vdGVybXMtb2YtdXNlLyAqIEB2ZXJzaW9uIFJlbGVhc2U6IDIuMy4wICogQHNpbmNlIEF2YWlsYWJsZSBzaW5jZSBSZWxlYXNlIDEuMC4wICovIGNsYXNzIEdvTWFnZV9Qcm9kdWN0RGVzaWduZXJfSGVscGVyX0RhdGEgZXh0ZW5kcyBNYWdlX0NvcmVfSGVscGVyX0Fic3RyYWN0IHsgY29uc3QgQURWQU5DRURfTkFWSUdBVElPTl9NT0RVTEVfTkFNRSA9ICdHb01hZ2VfTmF2aWdhdGlvbic7IHByb3RlY3RlZCAkX2FsbG93ZWRQcm9kdWN0VHlwZXMgPSBhcnJheSggTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3RfVHlwZTo6VFlQRV9TSU1QTEUsIE1hZ2VfQ2F0YWxvZ19Nb2RlbF9Qcm9kdWN0X1R5cGU6OlRZUEVfQ09ORklHVVJBQkxFICk7IHByb3RlY3RlZCAkX3Byb2R1Y3RTZXR0aW5nczsgcHJvdGVjdGVkICRfcHJvZHVjdERlc2lnbiA9IG51bGw7IHByb3RlY3RlZCAkX2VkaXRvckNvbmZpZyA9IG51bGw7IHB1YmxpYyBmdW5jdGlvbiBpc0VuYWJsZWQoKSB7IHJldHVybiBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2Rlc2lnbmVyL2dlbmVyYWwvZW5hYmxlZCcsIE1hZ2U6OmFwcCgpLT5nZXRTdG9yZSgpKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNOYXZpZ2F0aW9uRW5hYmxlZCgpIHsgcmV0dXJuIE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfZGVzaWduZXIvbmF2aWdhdGlvbi9lbmFibGVkJywgTWFnZTo6YXBwKCktPmdldFN0b3JlKCkpOyB9IHB1YmxpYyBmdW5jdGlvbiBhZHZhbmNlZE5hdmlnYXRpb25FbmFibGVkKCkgeyAkbW9kdWxlcyA9IChhcnJheSlNYWdlOjpnZXRDb25maWcoKS0+Z2V0Tm9kZSgnbW9kdWxlcycpLT5jaGlsZHJlbigpOyBpZiAoaXNzZXQoJG1vZHVsZXNbc2VsZjo6QURWQU5DRURfTkFWSUdBVElPTl9NT0RVTEVfTkFNRV0pKSB7ICRtb2R1bGUgPSAkbW9kdWxlc1tzZWxmOjpBRFZBTkNFRF9OQVZJR0FUSU9OX01PRFVMRV9OQU1FXTsgcmV0dXJuICRtb2R1bGUtPmlzKCdhY3RpdmUnKSAmJiBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vZ2VuZXJhbC9tb2RlJyk7IH0gcmV0dXJuIGZhbHNlOyB9IHB1YmxpYyBmdW5jdGlvbiBpc0VudGVycHJpc2VFZGl0aW9uKCkgeyAkbW9kdWxlcyA9IChhcnJheSlNYWdlOjpnZXRDb25maWcoKS0+Z2V0Tm9kZSgnbW9kdWxlcycpLT5jaGlsZHJlbigpOyByZXR1cm4gaXNzZXQoJG1vZHVsZXNbJ0VudGVycHJpc2VfVGFyZ2V0UnVsZSddKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0SXNBbnltb3JlVmVyc2lvbigkbWFqb3IsICRtaW5vciwgJHJldmlzaW9uID0gMCkgeyAkdmVyc2lvbl9pbmZvID0gTWFnZTo6Z2V0VmVyc2lvbkluZm8oKTsgaWYgKCR2ZXJzaW9uX2luZm9bJ21ham9yJ10gPiAkbWFqb3IpIHsgcmV0dXJuIHRydWU7IH0gZWxzZWlmICgkdmVyc2lvbl9pbmZvWydtYWpvciddID09ICRtYWpvcikgeyBpZiAoJHZlcnNpb25faW5mb1snbWlub3InXSA+ICRtaW5vcikgeyByZXR1cm4gdHJ1ZTsgfSBlbHNlaWYgKCR2ZXJzaW9uX2luZm9bJ21pbm9yJ10gPT0gJG1pbm9yKSB7IGlmICgkdmVyc2lvbl9pbmZvWydyZXZpc2lvbiddID49ICRyZXZpc2lvbikgeyByZXR1cm4gdHJ1ZTsgfSB9IH0gcmV0dXJuIGZhbHNlOyB9IC8qKiAqIFJldHVybiBhbGxvd2VkIHByb2R1Y3QgdHlwZXMgKiAqIEByZXR1cm4gYXJyYXkgKi8gcHVibGljIGZ1bmN0aW9uIGdldEFsbG93ZWRQcm9kdWN0VHlwZXMoKSB7IHJldHVybiAkdGhpcy0+X2FsbG93ZWRQcm9kdWN0VHlwZXM7IH0gcHVibGljIGZ1bmN0aW9uIGhhc0NvbG9yQXR0cmlidXRlKCkgeyAkYXR0cmlidXRlQ29kZSA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfZGVzaWduZXIvbmF2aWdhdGlvbi9jb2xvcl9hdHRyaWJ1dGUnKTsgJGF0dHJpYnV0ZSA9IE1hZ2U6OmdldFNpbmdsZXRvbignZWF2L2NvbmZpZycpIC0+Z2V0QXR0cmlidXRlKE1hZ2VfQ2F0YWxvZ19Nb2RlbF9Qcm9kdWN0OjpFTlRJVFksICRhdHRyaWJ1dGVDb2RlKTsgcmV0dXJuICRhdHRyaWJ1dGUtPmdldElkKCk7IH0gLyoqICogUmV0dXJuIEltYWdlIFNldHRpbmdzICogKiBAcGFyYW0gTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgJHByb2R1Y3QgUHJvZHVjdCAqIEBwYXJhbSBpbnQgJGltYWdlSWQgSW1hZ2UgSWQgKiBAcmV0dXJuIGJvb2xlYW58YXJyYXkgKi8gcHVibGljIGZ1bmN0aW9uIGdldEltYWdlU2V0dGluZ3MoTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgJHByb2R1Y3QsICRpbWFnZUlkKSB7ICRzZXR0aW5ncyA9ICR0aGlzLT5nZXRTZXR0aW5ncygkcHJvZHVjdCk7IGlmIChpc3NldCgkc2V0dGluZ3NbJGltYWdlSWRdKSkgeyByZXR1cm4gJHNldHRpbmdzWyRpbWFnZUlkXTsgfSByZXR1cm4gZmFsc2U7IH0gLyoqICogUmV0dXJuIFByb2R1Y3QgaW1hZ2VzIHNldHRpbmdzICogKiBAcGFyYW0gTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgJHByb2R1Y3QgUHJvZHVjdCAqIEByZXR1cm4gYXJyYXkgKi8gcHVibGljIGZ1bmN0aW9uIGdldFNldHRpbmdzKE1hZ2VfQ2F0YWxvZ19Nb2RlbF9Qcm9kdWN0ICRwcm9kdWN0KSB7IGlmICghJHRoaXMtPl9wcm9kdWN0U2V0dGluZ3MpIHsgJHNldHRpbmdzID0gYXJyYXkoKTsgJGltYWdlcyA9ICRwcm9kdWN0LT5nZXRNZWRpYUdhbGxlcnlJbWFnZXMoKTsgZm9yZWFjaCAoJGltYWdlcyBhcyAkaW1hZ2UpIHsgJGRlc2lnbkFyZWEgPSBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+anNvbkRlY29kZSgkaW1hZ2VbJ2Rlc2lnbl9hcmVhJ10pOyAkaW1hZ2VJZCA9ICRpbWFnZVsndmFsdWVfaWQnXTsgaWYgKCRkZXNpZ25BcmVhICYmICFlbXB0eSgkZGVzaWduQXJlYSkpIHsgJGltYWdlVXJsID0gJHRoaXMtPmdldERlc2lnbkltYWdlVXJsKCRwcm9kdWN0LCAkaW1hZ2UpOyAkZGltZW5zaW9ucyA9ICR0aGlzLT5nZXRJbWFnZURpbWVuc2lvbnMoJGltYWdlVXJsKTsgJGJhc2VVcmwgPSBNYWdlOjpnZXRCYXNlVXJsKCdtZWRpYScpOyAkYmFzZURpciA9IE1hZ2U6OmdldEJhc2VEaXIoJ21lZGlhJykgLiBEUzsgJGRlc2lnbkFyZWFbJ3BhdGgnXSA9IHN0cl9yZXBsYWNlKCRiYXNlVXJsLCAkYmFzZURpciwgJGltYWdlVXJsKTsgJGRlc2lnbkFyZWFbJ2RpbWVuc2lvbnMnXSA9IGFycmF5KCAnd2lkdGgnID0+ICRkaW1lbnNpb25zWzBdLCAnaGVpZ2h0JyA9PiAkZGltZW5zaW9uc1sxXSApOyAkZGVzaWduQXJlYVsnb3JpZ2luYWxfaW1hZ2UnXSA9ICR0aGlzLT5nZXRPcmlnaW5hbEltYWdlKCRwcm9kdWN0LCAkaW1hZ2UpOyBpZiAoaXNzZXQoJGRlc2lnbkFyZWFbJ29yaWdpbmFsX2ltYWdlJ11bJ3VybCddKSkgeyAkZGVzaWduQXJlYVsnb3JpZ2luYWxfaW1hZ2UnXVsncGF0aCddID0gc3RyX3JlcGxhY2UoICRiYXNlVXJsLCAkYmFzZURpciwgJGRlc2lnbkFyZWFbJ29yaWdpbmFsX2ltYWdlJ11bJ3VybCddICk7IH0gJHNldHRpbmdzWyRpbWFnZUlkXSA9ICRkZXNpZ25BcmVhOyB9IH0gJHRoaXMtPl9wcm9kdWN0U2V0dGluZ3MgPSAkc2V0dGluZ3M7IH0gcmV0dXJuICR0aGlzLT5fcHJvZHVjdFNldHRpbmdzOyB9IHB1YmxpYyBmdW5jdGlvbiBqc29uRGVjb2RlKCRzdHJpbmcpIHsgJHNldHRpbmdzID0gTWFnZTo6aGVscGVyKCdjb3JlJyktPmpzb25EZWNvZGUoJHN0cmluZyk7ICRyZXN1bHQgPSBhcnJheSgpOyBmb3JlYWNoICgkc2V0dGluZ3MgYXMgJGkgPT4gJHYpIHsgJHJlc3VsdFskaV0gPSAoYXJyYXkpJHY7IGlmICghaXNzZXQoJHJlc3VsdFskaV1bJ3MnXSkpIHsgJHJlc3VsdFskaV1bJ3MnXSA9IDE7IH0gfSByZXR1cm4gJHJlc3VsdDsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0SW1hZ2VEaW1lbnNpb25zKCRpbWFnZVBhdGgpIHsgJGRpckltZyA9IE1hZ2U6OmdldEJhc2VEaXIoKSAuIHN0cl9yZXBsYWNlKCIvIiwgRFMsIHN0cnN0cigkaW1hZ2VQYXRoLCAnL21lZGlhJykpOyBpZiAoZmlsZV9leGlzdHMoJGRpckltZykpIHsgJGltYWdlT2JqID0gbmV3IFZhcmllbl9JbWFnZSgkZGlySW1nKTsgJHdpZHRoID0gJGltYWdlT2JqLT5nZXRPcmlnaW5hbFdpZHRoKCk7ICRoZWlnaHQgPSAkaW1hZ2VPYmotPmdldE9yaWdpbmFsSGVpZ2h0KCk7IHJldHVybiBhcnJheSgkd2lkdGgsICRoZWlnaHQpOyB9IHJldHVybiBhcnJheSgwLCAwKTsgfSBwdWJsaWMgZnVuY3Rpb24gcHJlcGFyZURlc2lnbmVyU2Vzc2lvbklkKCkgeyAkY3VzdG9tZXJTZXNzaW9uID0gJHRoaXMtPl9nZXRDdXN0b21lclNlc3Npb24oKTsgaWYgKCEkY3VzdG9tZXJTZXNzaW9uLT5nZXREZXNpZ25lclNlc3Npb25JZCgpKSB7ICRjdXN0b21lclNlc3Npb24tPnNldERlc2lnbmVyU2Vzc2lvbklkKHNoYTEocmFuZCgwLCAxMDAwKSAuIG1pY3JvdGltZSh0cnVlKSkpOyB9IH0gcHVibGljIGZ1bmN0aW9uIGdldERlc2lnbmVyU2Vzc2lvbklkKCkgeyAkc2Vzc2lvbklkID0gJHRoaXMtPl9nZXRDdXN0b21lclNlc3Npb24oKS0+Z2V0RW5jcnlwdGVkU2Vzc2lvbklkKCk7IHJldHVybiAkc2Vzc2lvbklkOyB9IHByb3RlY3RlZCBmdW5jdGlvbiBfZ2V0Q3VzdG9tZXJTZXNzaW9uKCkgeyByZXR1cm4gTWFnZTo6Z2V0U2luZ2xldG9uKCdjdXN0b21lci9zZXNzaW9uJyk7IH0gcHVibGljIGZ1bmN0aW9uIGdldERlc2lnbldpZHRoKCkgeyByZXR1cm4gR29NYWdlX1Byb2R1Y3REZXNpZ25lcl9Nb2RlbF9EZXNpZ246OkRFU0lHTl9TSVpFX1dJRFRIOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXREZXNpZ25IZWlnaHQoKSB7IHJldHVybiBHb01hZ2VfUHJvZHVjdERlc2lnbmVyX01vZGVsX0Rlc2lnbjo6REVTSUdOX1NJWkVfSEVJR0hUOyB9IC8qKiAqIFJldHVybiBJbWFnZSBVcmwgKiAqIEBwYXJhbSBNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdCBQcm9kdWN0ICogQHBhcmFtIFZhcmllbl9PYmplY3QgJGltYWdlIEltYWdlICogQHBhcmFtIGFycmF5ICRzaXplIFNpemUgKiBAcmV0dXJuIHN0cmluZyAqLyBwdWJsaWMgZnVuY3Rpb24gZ2V0RGVzaWduSW1hZ2VVcmwoTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgJHByb2R1Y3QsICRpbWFnZSwgJHNpemUgPSBhcnJheSgpKSB7IGlmIChlbXB0eSgkc2l6ZSkpIHsgJGltYWdlV2lkdGggPSAkdGhpcy0+Z2V0RGVzaWduV2lkdGgoKTsgJGltYWdlSGVpZ2h0ID0gJHRoaXMtPmdldERlc2lnbkhlaWdodCgpOyB9IGVsc2UgeyBsaXN0KCRpbWFnZVdpZHRoLCAkaW1hZ2VIZWlnaHQpID0gJHNpemU7IH0gJGltYWdlRmlsZSA9IGlzX29iamVjdCgkaW1hZ2UpID8gJGltYWdlLT5nZXRGaWxlKCkgOiAkaW1hZ2VbJ2ZpbGUnXTsgcmV0dXJuIE1hZ2U6OmhlbHBlcignY2F0YWxvZy9pbWFnZScpIC0+aW5pdCgkcHJvZHVjdCwgJ2Jhc2VfaW1hZ2UnLCAkaW1hZ2VGaWxlKSAtPmtlZXBGcmFtZShmYWxzZSkgLT5yZXNpemUoJGltYWdlV2lkdGgsICRpbWFnZUhlaWdodCkgLT5fX3RvU3RyaW5nKCk7IH0gcHVibGljIGZ1bmN0aW9uIGdldE9yaWdpbmFsSW1hZ2UoTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgJHByb2R1Y3QsICRpbWFnZSkgeyAkaW1hZ2VGaWxlID0gaXNfb2JqZWN0KCRpbWFnZSkgPyAkaW1hZ2UtPmdldEZpbGUoKSA6ICRpbWFnZVsnZmlsZSddOyAkaW1hZ2VQYXRoID0gJHByb2R1Y3QtPmdldE1lZGlhQ29uZmlnKCktPmdldE1lZGlhUGF0aCgkaW1hZ2VGaWxlKTsgJG1pbldpZHRoID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9kZXNpZ25lci9nZW5lcmFsL3pvb21fc2l6ZV93aWR0aCcpOyAkbWluSGVpZ2h0ID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9kZXNpZ25lci9nZW5lcmFsL3pvb21fc2l6ZV9oZWlnaHQnKTsgaWYgKGZpbGVfZXhpc3RzKCRpbWFnZVBhdGgpKSB7ICRpbWFnZU9iaiA9IG5ldyBWYXJpZW5fSW1hZ2UoJGltYWdlUGF0aCk7ICR3aWR0aCA9ICRpbWFnZU9iai0+Z2V0T3JpZ2luYWxXaWR0aCgpOyAkaGVpZ2h0ID0gJGltYWdlT2JqLT5nZXRPcmlnaW5hbEhlaWdodCgpOyAkZGltZW5zaW9ucyA9IGFycmF5KCk7IGlmICgkd2lkdGggPCAkbWluV2lkdGggJiYgJGhlaWdodCA8ICRtaW5IZWlnaHQpIHsgJGRpbWVuc2lvbnNbMF0gPSAkbWluV2lkdGg7ICRkaW1lbnNpb25zWzFdID0gJG1pbkhlaWdodDsgfSBlbHNlIHsgJGRpbWVuc2lvbnNbMF0gPSAkd2lkdGg7ICRkaW1lbnNpb25zWzFdID0gJGhlaWdodDsgfSByZXR1cm4gYXJyYXkoICd1cmwnID0+ICR0aGlzLT5nZXREZXNpZ25JbWFnZVVybCgkcHJvZHVjdCwgJGltYWdlLCAkZGltZW5zaW9ucyksICdkaW1lbnNpb25zJyA9PiAkZGltZW5zaW9ucyApOyB9IHJldHVybiBhcnJheSgpOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRQcm9kdWN0U2V0dGluZ0ZvckVkaXRvcihNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdCA9IG51bGwpIHsgaWYgKCEkdGhpcy0+X2VkaXRvckNvbmZpZykgeyBpZiAoaXNfbnVsbCgkcHJvZHVjdCkpIHsgJHByb2R1Y3QgPSBNYWdlOjpyZWdpc3RyeSgncHJvZHVjdCcpOyB9ICRlZGl0b3JDb25maWcgPSBhcnJheSggJ2ltYWdlcycgPT4gYXJyYXkoKSApOyBpZiAoISRwcm9kdWN0LT5nZXRJZCgpKSB7IHJldHVybiAkZWRpdG9yQ29uZmlnOyB9ICRpbWFnZXMgPSAkcHJvZHVjdC0+Z2V0TWVkaWFHYWxsZXJ5SW1hZ2VzKCk7ICRjb2xvckF0dHJpYnV0ZUNvZGUgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2Rlc2lnbmVyL25hdmlnYXRpb24vY29sb3JfYXR0cmlidXRlJyk7ICRkZWZhdWx0Q29sb3IgPSBudWxsOyBmb3JlYWNoICgkaW1hZ2VzIGFzICRpbWFnZSkgeyAkaWQgPSAkaW1hZ2VbJ3ZhbHVlX2lkJ107ICRzZXR0aW5ncyA9IE1hZ2U6OmhlbHBlcignY29yZScpLT5qc29uRGVjb2RlKCRpbWFnZVsnZGVzaWduX2FyZWEnXSk7IGlmICghJHNldHRpbmdzIHx8IGVtcHR5KCRzZXR0aW5ncykpIHsgY29udGludWU7IH0gJGltYWdlVXJsID0gJHRoaXMtPmdldERlc2lnbkltYWdlVXJsKCRwcm9kdWN0LCAkaW1hZ2UpOyAkY29uZiA9ICRzZXR0aW5nczsgJGNvbmZbJ2lkJ10gPSAkaWQ7ICRjb25mWyd1J10gPSAkaW1hZ2VVcmw7ICRjb25mWydkJ10gPSAkdGhpcy0+Z2V0SW1hZ2VEaW1lbnNpb25zKCRpbWFnZVVybCk7ICRjb25mWydvcmlnX2ltYWdlJ10gPSAkdGhpcy0+Z2V0T3JpZ2luYWxJbWFnZSgkcHJvZHVjdCwgJGltYWdlKTsgJGNvbmZbJ2ljbyddID0gJHRoaXMtPmdldERlc2lnbkltYWdlVXJsKCRwcm9kdWN0LCAkaW1hZ2UsIGFycmF5KDYwLCA2MCkpOyBpZiAoJHByb2R1Y3QtPmdldFR5cGVJZCgpID09IE1hZ2VfQ2F0YWxvZ19Nb2RlbF9Qcm9kdWN0X1R5cGU6OlRZUEVfQ09ORklHVVJBQkxFKSB7IGlmICgkaW1hZ2VbJ2NvbG9yJ10pIHsgaWYgKGlzX251bGwoJGRlZmF1bHRDb2xvcikpIHsgJGRlZmF1bHRDb2xvciA9ICRpbWFnZVsnY29sb3InXTsgfSBpZiAoIWlzc2V0KCRlZGl0b3JDb25maWdbJ2ltYWdlcyddWyRpbWFnZVsnY29sb3InXV0pKSB7ICRlZGl0b3JDb25maWdbJ2ltYWdlcyddWyRpbWFnZVsnY29sb3InXV0gPSBhcnJheSgpOyB9ICRlZGl0b3JDb25maWdbJ2ltYWdlcyddWyRpbWFnZVsnY29sb3InXV1bJGlkXSA9ICRjb25mOyB9IGVsc2UgeyAkZGVmYXVsdENvbG9yID0gJHByb2R1Y3QtPmdldERhdGEoJGNvbG9yQXR0cmlidXRlQ29kZSkgPzogJ25vbmVfY29sb3InOyAkZWRpdG9yQ29uZmlnWydpbWFnZXMnXVskZGVmYXVsdENvbG9yXVskaWRdID0gJGNvbmY7IH0gfSBlbHNlIHsgJGRlZmF1bHRDb2xvciA9ICdub25lX2NvbG9yJzsgJGVkaXRvckNvbmZpZ1snaW1hZ2VzJ11bJGRlZmF1bHRDb2xvcl1bJGlkXSA9ICRjb25mOyB9ICRlZGl0b3JDb25maWdbJ2RlZmF1bHRfY29sb3InXSA9ICRkZWZhdWx0Q29sb3I7ICRlZGl0b3JDb25maWdbJ3VybCddID0gJHByb2R1Y3QtPmdldFByb2R1Y3RVcmwoKTsgJGVkaXRvckNvbmZpZ1snbmFtZSddID0gJHByb2R1Y3QtPmdldE5hbWUoKTsgfSAkdGhpcy0+X2VkaXRvckNvbmZpZyA9ICRlZGl0b3JDb25maWc7IH0gcmV0dXJuICR0aGlzLT5fZWRpdG9yQ29uZmlnOyB9IC8qKiAqIFNhdmUgcHJvZHVjdCBkZXNpZ24gaW1hZ2VzICogKiBAcmV0dXJuIEdvTWFnZV9Qcm9kdWN0RGVzaWduZXJfTW9kZWxfRGVzaWduICogQHRocm93cyBFeGNlcHRpb24gKi8gcHVibGljIGZ1bmN0aW9uIHNhdmVQcm9kdWN0RGVzaWduZWRJbWFnZXMoKSB7ICRwcm9kdWN0ID0gJHRoaXMtPmluaXRpYWxpemVQcm9kdWN0KCk7ICRpbWFnZXMgPSBNYWdlOjphcHAoKS0+Z2V0UmVxdWVzdCgpLT5nZXRQYXJhbSgnaW1hZ2VzJyk7IGlmICgkcHJvZHVjdC0+Z2V0SWQoKSAmJiAkaW1hZ2VzICYmICFlbXB0eSgkaW1hZ2VzKSkgeyAkZGVzaWduID0gTWFnZTo6Z2V0TW9kZWwoJ2dvbWFnZV9kZXNpZ25lci9kZXNpZ24nKS0+c2F2ZURlc2lnbigkcHJvZHVjdCwgJHRoaXMtPl9nZXRSZXF1ZXN0KCktPmdldFBhcmFtcygpKTsgcmV0dXJuICRkZXNpZ247IH0gZWxzZWlmICghJHByb2R1Y3QtPmdldElkKCkpIHsgdGhyb3cgbmV3IEV4Y2VwdGlvbihNYWdlOjpoZWxwZXIoJ2dvbWFnZV9kZXNpZ25lcicpLT5fXygnUHJvZHVjdCBpcyBub3QgZGVmaW5lZCcpKTsgfSBlbHNlaWYgKCEkaW1hZ2VzIHx8IGVtcHR5KCRpbWFnZXMpKSB7IHRocm93IG5ldyBFeGNlcHRpb24oTWFnZTo6aGVscGVyKCdnb21hZ2VfZGVzaWduZXInKS0+X18oJ0Rlc2lnbmVkIGltYWdlcyBhcmUgZW1wdHknKSk7IH0gfSAvKiogKiBJbml0aWFsaXplIGN1cnJlbnQgcHJvZHVjdCBmcm9tIHJlcXVlc3QgKiAqIEByZXR1cm4gTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgKi8gcHVibGljIGZ1bmN0aW9uIGluaXRpYWxpemVQcm9kdWN0KCkgeyAkcHJvZHVjdCA9IE1hZ2U6OnJlZ2lzdHJ5KCdwcm9kdWN0Jyk7IGlmICgkcHJvZHVjdCkgeyByZXR1cm4gJHByb2R1Y3Q7IH0gJHJlcXVlc3QgPSBNYWdlOjphcHAoKS0+Z2V0UmVxdWVzdCgpOyAkcHJvZHVjdElkID0gJHJlcXVlc3QtPmdldFBhcmFtKCJpZCIsIGZhbHNlKTsgJHByb2R1Y3QgPSBNYWdlOjpnZXRNb2RlbCgnY2F0YWxvZy9wcm9kdWN0Jyk7IGlmICgkcHJvZHVjdElkKSB7ICRwcm9kdWN0LT5sb2FkKCRwcm9kdWN0SWQpOyB9IE1hZ2U6OnJlZ2lzdGVyKCdwcm9kdWN0JywgJHByb2R1Y3QpOyByZXR1cm4gJHByb2R1Y3Q7IH0gLyoqICogUHJpY2UgY2FsY3VsYXRpb24gZGVwZW5kaW5nIG9uIHByb2R1Y3Qgb3B0aW9ucyAqICogQHJldHVybiBhcnJheSAqLyBwdWJsaWMgZnVuY3Rpb24gZ2V0UHJvZHVjdFByaWNlQ29uZmlnKCkgeyAkY29uZmlnID0gYXJyYXkoKTsgJF9yZXF1ZXN0ID0gTWFnZTo6Z2V0U2luZ2xldG9uKCd0YXgvY2FsY3VsYXRpb24nKS0+Z2V0UmF0ZVJlcXVlc3QoZmFsc2UsIGZhbHNlLCBmYWxzZSk7IC8qIEB2YXIgJHByb2R1Y3QgTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgKi8gJHByb2R1Y3QgPSAkdGhpcy0+aW5pdGlhbGl6ZVByb2R1Y3QoKTsgJF9yZXF1ZXN0LT5zZXRQcm9kdWN0Q2xhc3NJZCgkcHJvZHVjdC0+Z2V0VGF4Q2xhc3NJZCgpKTsgJGRlZmF1bHRUYXggPSBNYWdlOjpnZXRTaW5nbGV0b24oJ3RheC9jYWxjdWxhdGlvbicpLT5nZXRSYXRlKCRfcmVxdWVzdCk7ICRfcmVxdWVzdCA9IE1hZ2U6OmdldFNpbmdsZXRvbigndGF4L2NhbGN1bGF0aW9uJyktPmdldFJhdGVSZXF1ZXN0KCk7ICRfcmVxdWVzdC0+c2V0UHJvZHVjdENsYXNzSWQoJHByb2R1Y3QtPmdldFRheENsYXNzSWQoKSk7ICRjdXJyZW50VGF4ID0gTWFnZTo6Z2V0U2luZ2xldG9uKCd0YXgvY2FsY3VsYXRpb24nKS0+Z2V0UmF0ZSgkX3JlcXVlc3QpOyAkX3JlZ3VsYXJQcmljZSA9ICRwcm9kdWN0LT5nZXRQcmljZSgpOyAkX2ZpbmFsUHJpY2UgPSAkcHJvZHVjdC0+Z2V0RmluYWxQcmljZSgpOyAkX3ByaWNlSW5jbFRheCA9IE1hZ2U6OmhlbHBlcigndGF4JyktPmdldFByaWNlKCRwcm9kdWN0LCAkX2ZpbmFsUHJpY2UsIHRydWUpOyAkX3ByaWNlRXhjbFRheCA9IE1hZ2U6OmhlbHBlcigndGF4JyktPmdldFByaWNlKCRwcm9kdWN0LCAkX2ZpbmFsUHJpY2UpOyAkX3RpZXJQcmljZXMgPSBhcnJheSgpOyAkX3RpZXJQcmljZXNJbmNsVGF4ID0gYXJyYXkoKTsgZm9yZWFjaCAoJHByb2R1Y3QtPmdldFRpZXJQcmljZSgpIGFzICR0aWVyUHJpY2UpIHsgJF90aWVyUHJpY2VzW10gPSBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+Y3VycmVuY3koJHRpZXJQcmljZVsnd2Vic2l0ZV9wcmljZSddLCBmYWxzZSwgZmFsc2UpOyAkX3RpZXJQcmljZXNJbmNsVGF4W10gPSBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+Y3VycmVuY3koIE1hZ2U6OmhlbHBlcigndGF4JyktPmdldFByaWNlKCRwcm9kdWN0LCAoaW50KSR0aWVyUHJpY2VbJ3dlYnNpdGVfcHJpY2UnXSwgdHJ1ZSksIGZhbHNlLCBmYWxzZSApOyB9ICRjb25maWcgPSBhcnJheSggJ3Byb2R1Y3RJZCcgPT4gJHByb2R1Y3QtPmdldElkKCksICdwcmljZUZvcm1hdCcgPT4gTWFnZTo6YXBwKCktPmdldExvY2FsZSgpLT5nZXRKc1ByaWNlRm9ybWF0KCksICdpbmNsdWRlVGF4JyA9PiBNYWdlOjpoZWxwZXIoJ3RheCcpLT5wcmljZUluY2x1ZGVzVGF4KCkgPyAndHJ1ZScgOiAnZmFsc2UnLCAnc2hvd0luY2x1ZGVUYXgnID0+IE1hZ2U6OmhlbHBlcigndGF4JyktPmRpc3BsYXlQcmljZUluY2x1ZGluZ1RheCgpLCAnc2hvd0JvdGhQcmljZXMnID0+IE1hZ2U6OmhlbHBlcigndGF4JyktPmRpc3BsYXlCb3RoUHJpY2VzKCksICdwcm9kdWN0UHJpY2UnID0+IE1hZ2U6OmhlbHBlcignY29yZScpLT5jdXJyZW5jeSgkX2ZpbmFsUHJpY2UsIGZhbHNlLCBmYWxzZSksICdwcm9kdWN0T2xkUHJpY2UnID0+IE1hZ2U6OmhlbHBlcignY29yZScpLT5jdXJyZW5jeSgkX3JlZ3VsYXJQcmljZSwgZmFsc2UsIGZhbHNlKSwgJ3ByaWNlSW5jbFRheCcgPT4gTWFnZTo6aGVscGVyKCdjb3JlJyktPmN1cnJlbmN5KCRfcHJpY2VJbmNsVGF4LCBmYWxzZSwgZmFsc2UpLCAncHJpY2VFeGNsVGF4JyA9PiBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+Y3VycmVuY3koJF9wcmljZUV4Y2xUYXgsIGZhbHNlLCBmYWxzZSksIC8qKiAqIEB2YXIgc2tpcENhbGN1bGF0ZSAqIEBkZXByZWNhdGVkIGFmdGVyIDEuNS4xLjAgKi8gJ3NraXBDYWxjdWxhdGUnID0+ICgkX3ByaWNlRXhjbFRheCAhPSAkX3ByaWNlSW5jbFRheCA/IDAgOiAxKSwgJ2RlZmF1bHRUYXgnID0+ICRkZWZhdWx0VGF4LCAnY3VycmVudFRheCcgPT4gJGN1cnJlbnRUYXgsICdpZFN1ZmZpeCcgPT4gJ19jbG9uZScsICdvbGRQbHVzRGlzcG9zaXRpb24nID0+IDAsICdwbHVzRGlzcG9zaXRpb24nID0+IDAsICdwbHVzRGlzcG9zaXRpb25UYXgnID0+IDAsICdvbGRNaW51c0Rpc3Bvc2l0aW9uJyA9PiAwLCAnbWludXNEaXNwb3NpdGlvbicgPT4gMCwgJ3RpZXJQcmljZXMnID0+ICRfdGllclByaWNlcywgJ3RpZXJQcmljZXNJbmNsVGF4JyA9PiAkX3RpZXJQcmljZXNJbmNsVGF4LCApOyAkcmVzcG9uc2VPYmplY3QgPSBuZXcgVmFyaWVuX09iamVjdCgpOyBNYWdlOjpkaXNwYXRjaEV2ZW50KCdjYXRhbG9nX3Byb2R1Y3Rfdmlld19jb25maWcnLCBhcnJheSgncmVzcG9uc2Vfb2JqZWN0JyA9PiAkcmVzcG9uc2VPYmplY3QpKTsgaWYgKGlzX2FycmF5KCRyZXNwb25zZU9iamVjdC0+Z2V0QWRkaXRpb25hbE9wdGlvbnMoKSkpIHsgZm9yZWFjaCAoJHJlc3BvbnNlT2JqZWN0LT5nZXRBZGRpdGlvbmFsT3B0aW9ucygpIGFzICRvcHRpb24gPT4gJHZhbHVlKSB7ICRjb25maWdbJG9wdGlvbl0gPSAkdmFsdWU7IH0gfSByZXR1cm4gJGNvbmZpZzsgfSBwdWJsaWMgZnVuY3Rpb24gZm9ybWF0RmlsZU5hbWUoJGZpbGUpIHsgJGZvcm1hdFJlc3VsdCA9IE1hZ2U6OmhlbHBlcignY2F0YWxvZy9wcm9kdWN0X3VybCcpLT5mb3JtYXQoJGZpbGUpOyByZXR1cm4gcHJlZ19yZXBsYWNlKCcjW1xzXSsjaScsICctJywgJGZvcm1hdFJlc3VsdCk7IH0gcHVibGljIGZ1bmN0aW9uIGNhbkFwcGx5TXNycCgkcHJvZHVjdCwgJHZpc2liaWxpdHkgPSBudWxsLCAkY2hlY2tBc3NvY2lhdGVkSXRlbXMgPSB0cnVlKSB7ICR2ZXJzaW9uID0gTWFnZTo6Z2V0VmVyc2lvbkluZm8oKTsgaWYgKCgkdmVyc2lvblsnbWFqb3InXSA9PT0gJzEnKSAmJiAoKGludCkkdmVyc2lvblsnbWlub3InXSA8PSA1KSkgeyByZXR1cm4gZmFsc2U7IH0gZWxzZWlmIChtZXRob2RfZXhpc3RzKE1hZ2U6OmhlbHBlcignY2F0YWxvZycpLCAnY2FuQXBwbHlNc3JwJykpIHsgcmV0dXJuIE1hZ2U6OmhlbHBlcignY2F0YWxvZycpLT5jYW5BcHBseU1zcnAoJHByb2R1Y3QsICR2aXNpYmlsaXR5LCAkY2hlY2tBc3NvY2lhdGVkSXRlbXMpOyB9IHJldHVybiBmYWxzZTsgfSAvKiogKiBSZXRyaWV2ZSB1cmwgZm9yIGFkZGluZyBwcm9kdWN0IHRvIHdpc2hsaXN0ICogKiBAcGFyYW0gaW50ICRpdGVtSWQgKiAqIEByZXR1cm4gc3RyaW5nICovIHB1YmxpYyBmdW5jdGlvbiBnZXRNb3ZlRnJvbUNhcnRVcmwoJGl0ZW1JZCkgeyAkdmVyc2lvbiA9IE1hZ2U6OmdldFZlcnNpb25JbmZvKCk7IGlmICgoJHZlcnNpb25bJ21ham9yJ10gPT09ICcxJykgJiYgKChpbnQpJHZlcnNpb25bJ21pbm9yJ10gPD0gNSkpIHsgcmV0dXJuIGZhbHNlOyB9IGVsc2UgeyBpZiAobWV0aG9kX2V4aXN0cyhNYWdlOjpoZWxwZXIoJ3dpc2hsaXN0JyksICdnZXRNb3ZlRnJvbUNhcnRVcmwnKSkgeyByZXR1cm4gTWFnZTo6aGVscGVyKCd3aXNobGlzdCcpLT5nZXRNb3ZlRnJvbUNhcnRVcmwoJGl0ZW1JZCk7IH0gfSByZXR1cm4gZmFsc2U7IH0gLyoqICogR2V0IEpTT04gZW5jb2RlZCBjb25maWd1cmF0aW9uIGFycmF5IHdoaWNoIGNhbiBiZSB1c2VkIGZvciBKUyBkeW5hbWljICogKiBAcmV0dXJuIHN0cmluZyAqLyBwdWJsaWMgZnVuY3Rpb24gZ2V0UHJvZHVjdFByaWNlQ29uZmlnSnNvbigpIHsgcmV0dXJuIE1hZ2U6OmhlbHBlcignY29yZScpLT5qc29uRW5jb2RlKCR0aGlzLT5nZXRQcm9kdWN0UHJpY2VDb25maWcoKSk7IH0gLyoqICogUmV0dXJuIHByb2R1Y3QgZGVzaWduIGZyb20gcmVxdWVzdCAqICogQHBhcmFtIE1hZ2VfQ2F0YWxvZ19Nb2RlbF9Qcm9kdWN0ICRwcm9kdWN0IFByb2R1Y3QgKiBAcmV0dXJuIGJvb2x8TWFnZV9Db3JlX01vZGVsX0Fic3RyYWN0ICovIHB1YmxpYyBmdW5jdGlvbiBnZXRQcm9kdWN0RGVzaWduKCRwcm9kdWN0KSB7IGlmIChpc19udWxsKCR0aGlzLT5fcHJvZHVjdERlc2lnbikpIHsgJGRlc2lnbklkID0gKGludClNYWdlOjphcHAoKS0+Z2V0UmVxdWVzdCgpLT5nZXRQYXJhbSgnZGVzaWduX2lkJywgZmFsc2UpOyBpZiAoJGRlc2lnbklkKSB7ICRkZXNpZ24gPSBNYWdlOjpnZXRNb2RlbCgnZ29tYWdlX2Rlc2lnbmVyL2Rlc2lnbicpLT5sb2FkKCRkZXNpZ25JZCk7IGlmICgkZGVzaWduLT5nZXRJZCgpICYmICRkZXNpZ24tPmdldFByb2R1Y3RJZCgpID09ICRwcm9kdWN0LT5nZXRJZCgpKSB7ICR0aGlzLT5fcHJvZHVjdERlc2lnbiA9ICRkZXNpZ247IH0gZWxzZSB7ICR0aGlzLT5fcHJvZHVjdERlc2lnbiA9IGZhbHNlOyB9IH0gfSByZXR1cm4gJHRoaXMtPl9wcm9kdWN0RGVzaWduOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRBbGxTdG9yZURvbWFpbnMoKSB7ICRkb21haW5zID0gYXJyYXkoKTsgZm9yZWFjaCAoTWFnZTo6YXBwKCktPmdldFdlYnNpdGVzKCkgYXMgJHdlYnNpdGUpIHsgJHVybCA9ICR3ZWJzaXRlLT5nZXRDb25maWcoJ3dlYi91bnNlY3VyZS9iYXNlX3VybCcpOyBpZiAoJGRvbWFpbiA9IHRyaW0ocHJlZ19yZXBsYWNlKCcvXi4qP1xcL1xcLyguKik/XFwvLycsICckMScsICR1cmwpKSkgeyAkZG9tYWluc1tdID0gJGRvbWFpbjsgfSAkdXJsID0gJHdlYnNpdGUtPmdldENvbmZpZygnd2ViL3NlY3VyZS9iYXNlX3VybCcpOyBpZiAoJGRvbWFpbiA9IHRyaW0ocHJlZ19yZXBsYWNlKCcvXi4qP1xcL1xcLyguKik/XFwvLycsICckMScsICR1cmwpKSkgeyAkZG9tYWluc1tdID0gJGRvbWFpbjsgfSB9IHJldHVybiBhcnJheV91bmlxdWUoJGRvbWFpbnMpOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRXaW5kb3dDc3NQYXRoKCkgeyBpZiAoISR0aGlzLT5nZXRJc0FueW1vcmVWZXJzaW9uKDEsIDcpKSB7IHJldHVybiAncHJvdG90eXBlL3dpbmRvd3MvdGhlbWVzL21hZ2VudG8uY3NzJzsgfSBlbHNlIHsgcmV0dXJuICdsaWIvcHJvdG90eXBlL3dpbmRvd3MvdGhlbWVzL21hZ2VudG8uY3NzJzsgfSB9IHB1YmxpYyBmdW5jdGlvbiBnZXRDc3NUeXBlKCkgeyBpZiAoISR0aGlzLT5nZXRJc0FueW1vcmVWZXJzaW9uKDEsIDcpKSB7IHJldHVybiAnanNfY3NzJzsgfSBlbHNlIHsgcmV0dXJuICdza2luX2Nzcyc7IH0gfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QXZhaWxhYmxlV2Vic2l0ZXMoKSB7IHJldHVybiAkdGhpcy0+X3coKTsgfSBwcm90ZWN0ZWQgZnVuY3Rpb24gX3coKSB7IGlmICghTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2Rlc2lnbmVyL2luc3RhbGxlZCcpIHx8IChpbnR2YWwoTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2Rlc2lnbmVyL2NvdW50JykpID4gMTApICkgeyByZXR1cm4gYXJyYXkoKTsgfSAkdGltZV90b191cGRhdGUgPSA2MCAqIDYwICogMjQgKiAxNTsgJHIgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vZGVzaWduZXIvYXInKTsgJHQgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vZGVzaWduZXIvdGltZScpOyAkcyA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9kZXNpZ25lci93ZWJzaXRlcycpOyAkbGFzdF9jaGVjayA9IHN0cl9yZXBsYWNlKCRyLCAnJywgTWFnZTo6aGVscGVyKCdjb3JlJyktPmRlY3J5cHQoJHQpKTsgJGFsbHNpdGVzID0gZXhwbG9kZSgnLCcsIHN0cl9yZXBsYWNlKCRyLCAnJywgTWFnZTo6aGVscGVyKCdjb3JlJyktPmRlY3J5cHQoJHMpKSk7ICRhbGxzaXRlcyA9IGFycmF5X2RpZmYoJGFsbHNpdGVzLCBhcnJheSgiIikpOyBpZiAoKCRsYXN0X2NoZWNrICsgJHRpbWVfdG9fdXBkYXRlKSA8IHRpbWUoKSkgeyAkdGhpcy0+YShNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vZGVzaWduZXIva2V5JyksIGludHZhbChNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vZGVzaWduZXIvY291bnQnKSksIGltcGxvZGUoJywnLCAkYWxsc2l0ZXMpICk7IH0gcmV0dXJuICRhbGxzaXRlczsgfSBwdWJsaWMgZnVuY3Rpb24gYSgkaywgJGMgPSAwLCAkcyA9ICcnKSB7ICRjaCA9IGN1cmxfaW5pdCgpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCBzcHJpbnRmKCdodHRwczovL3d3dy5nb21hZ2UuY29tL2luZGV4LnBocC9nb21hZ2VfZG93bmxvYWRhYmxlL2tleS9jaGVjaycpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1QsIHRydWUpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVEZJRUxEUywgJ2tleT0nIC4gdXJsZW5jb2RlKCRrKSAuICcmc2t1PXByb2R1Y3QtZGVzaWduZXImZG9tYWlucz0nIC4gdXJsZW5jb2RlKGltcGxvZGUoJywnLCAkdGhpcy0+Z2V0QWxsU3RvcmVEb21haW5zKCkpKSAuICcmdmVyPScgLiB1cmxlbmNvZGUoJzIuMicpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDMwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCAwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllIT1NULCAwKTsgJGNvbnRlbnQgPSBjdXJsX2V4ZWMoJGNoKTsgJHIgPSBaZW5kX0pzb246OmRlY29kZSgkY29udGVudCk7ICRlID0gTWFnZTo6aGVscGVyKCdjb3JlJyk7IGlmIChlbXB0eSgkcikpIHsgJHZhbHVlMSA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9kZXNpZ25lci9hcicpOyAkZ3JvdXBzID0gYXJyYXkoICdkZXNpZ25lcicgPT4gYXJyYXkoICdmaWVsZHMnID0+IGFycmF5KCAnYXInID0+IGFycmF5KCAndmFsdWUnID0+ICR2YWx1ZTEgKSwgJ3dlYnNpdGVzJyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAoc3RyaW5nKU1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9kZXNpZ25lci93ZWJzaXRlcycpICksICd0aW1lJyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAoc3RyaW5nKSRlLT5lbmNyeXB0KCR2YWx1ZTEgLiAodGltZSgpIC0gKDYwICogNjAgKiAyNCAqIDE1IC0gMTgwMCkpIC4gJHZhbHVlMSkgKSwgJ2NvdW50JyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAkYyArIDEpICkgKSApOyBNYWdlOjpnZXRNb2RlbCgnYWRtaW5odG1sL2NvbmZpZ19kYXRhJykgLT5zZXRTZWN0aW9uKCdnb21hZ2VfYWN0aXZhdGlvbicpIC0+c2V0R3JvdXBzKCRncm91cHMpIC0+c2F2ZSgpOyBNYWdlOjpnZXRDb25maWcoKS0+cmVpbml0KCk7IE1hZ2U6OmFwcCgpLT5yZWluaXRTdG9yZXMoKTsgcmV0dXJuOyB9ICR2YWx1ZTEgPSAnJzsgJHZhbHVlMiA9ICcnOyBpZiAoaXNzZXQoJHJbJ2QnXSkgJiYgaXNzZXQoJHJbJ2MnXSkpIHsgJHZhbHVlMSA9ICRlLT5lbmNyeXB0KGJhc2U2NF9lbmNvZGUoWmVuZF9Kc29uOjplbmNvZGUoJHIpKSk7IGlmICghJHMpIHsgJHMgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vZGVzaWduZXIvd2Vic2l0ZXMnKTsgfSAkcyA9IGFycmF5X3NsaWNlKGV4cGxvZGUoJywnLCAkcyksIDAsICRyWydjJ10pOyAkdmFsdWUyID0gJGUtPmVuY3J5cHQoJHZhbHVlMSAuIGltcGxvZGUoJywnLCAkcykgLiAkdmFsdWUxKTsgfSAkZ3JvdXBzID0gYXJyYXkoICdkZXNpZ25lcicgPT4gYXJyYXkoICdmaWVsZHMnID0+IGFycmF5KCAnYXInID0+IGFycmF5KCAndmFsdWUnID0+ICR2YWx1ZTEgKSwgJ3dlYnNpdGVzJyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAoc3RyaW5nKSR2YWx1ZTIgKSwgJ3RpbWUnID0+IGFycmF5KCAndmFsdWUnID0+IChzdHJpbmcpJGUtPmVuY3J5cHQoJHZhbHVlMSAuIHRpbWUoKSAuICR2YWx1ZTEpICksICdpbnN0YWxsZWQnID0+IGFycmF5KCAndmFsdWUnID0+IDEgKSwgJ2NvdW50JyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAwKSApICkgKTsgTWFnZTo6Z2V0TW9kZWwoJ2FkbWluaHRtbC9jb25maWdfZGF0YScpIC0+c2V0U2VjdGlvbignZ29tYWdlX2FjdGl2YXRpb24nKSAtPnNldEdyb3VwcygkZ3JvdXBzKSAtPnNhdmUoKTsgTWFnZTo6Z2V0Q29uZmlnKCktPnJlaW5pdCgpOyBNYWdlOjphcHAoKS0+cmVpbml0U3RvcmVzKCk7IH0gcHVibGljIGZ1bmN0aW9uIGdhKCkgeyByZXR1cm4gWmVuZF9Kc29uOjpkZWNvZGUoYmFzZTY0X2RlY29kZShNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdChNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vZGVzaWduZXIvYXInKSkpKTsgfSBwdWJsaWMgZnVuY3Rpb24gbm90aWZ5KCkgeyAkZnJlcXVlbmN5ID0gaW50dmFsKE1hZ2U6OmFwcCgpLT5sb2FkQ2FjaGUoJ2dvbWFnZV9ub3RpZmljYXRpb25zX2ZyZXF1ZW5jeScpKTsgaWYgKCEkZnJlcXVlbmN5KSB7ICRmcmVxdWVuY3kgPSAyNDsgfSAkbGFzdF91cGRhdGUgPSBpbnR2YWwoTWFnZTo6YXBwKCktPmxvYWRDYWNoZSgnZ29tYWdlX25vdGlmaWNhdGlvbnNfbGFzdF91cGRhdGUnKSk7IGlmICgoJGZyZXF1ZW5jeSAqIDYwICogNjAgKyAkbGFzdF91cGRhdGUpID4gdGltZSgpKSB7IHJldHVybiBmYWxzZTsgfSAkdGltZXN0YW1wID0gJGxhc3RfdXBkYXRlOyBpZiAoISR0aW1lc3RhbXApIHsgJHRpbWVzdGFtcCA9IHRpbWUoKTsgfSB0cnkgeyAkY2ggPSBjdXJsX2luaXQoKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgc3ByaW50ZignaHR0cHM6Ly93d3cuZ29tYWdlLmNvbS9pbmRleC5waHAvZ29tYWdlX25vdGlmaWNhdGlvbi9pbmRleC9kYXRhJykpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVCwgdHJ1ZSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NURklFTERTLCAnc2t1PXByb2R1Y3QtZGVzaWduZXImdGltZXN0YW1wPScgLiAkdGltZXN0YW1wIC4gJyZ2ZXI9JyAuIHVybGVuY29kZSgnMi4zJykpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwgMzApOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsIDApOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWUhPU1QsIDApOyAkY29udGVudCA9IGN1cmxfZXhlYygkY2gpOyAkcmVzdWx0ID0gWmVuZF9Kc29uOjpkZWNvZGUoJGNvbnRlbnQpOyBpZiAoJHJlc3VsdCAmJiBpc3NldCgkcmVzdWx0WydmcmVxdWVuY3knXSkgJiYgKCRyZXN1bHRbJ2ZyZXF1ZW5jeSddICE9ICRmcmVxdWVuY3kpKSB7IE1hZ2U6OmFwcCgpLT5zYXZlQ2FjaGUoJHJlc3VsdFsnZnJlcXVlbmN5J10sICdnb21hZ2Vfbm90aWZpY2F0aW9uc19mcmVxdWVuY3knKTsgfSBpZiAoJHJlc3VsdCAmJiBpc3NldCgkcmVzdWx0WydkYXRhJ10pKSB7IGlmICghZW1wdHkoJHJlc3VsdFsnZGF0YSddKSkgeyBNYWdlOjpnZXRNb2RlbCgnYWRtaW5ub3RpZmljYXRpb24vaW5ib3gnKS0+cGFyc2UoJHJlc3VsdFsnZGF0YSddKTsgfSB9IH0gY2F0Y2ggKEV4Y2VwdGlvbiAkZSkgeyB9IE1hZ2U6OmFwcCgpLT5zYXZlQ2FjaGUodGltZSgpLCAnZ29tYWdlX25vdGlmaWNhdGlvbnNfbGFzdF91cGRhdGUnKTsgfSB9"));