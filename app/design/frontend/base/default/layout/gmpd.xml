<?xml version="1.0"?>
<!--
 /**
 * GoMage ProductDesigner Extension
 *
 * @category     Extension
 * @copyright    Copyright (c) 2010-2012 GoMage (http://www.gomage.com)
 * @author       GoMage
 * @license      http://www.gomage.com/license-agreement/  Single domain license
 * @terms of use http://www.gomage.com/terms-of-use
 * @version      Release: 1.0
 * @since        Available since Release 1.0
 */
 -->
<layout version="0.1.0">
    <!-- Editor page /designer -->
    <gomage_designer_index_index translate="label">
        <label>GoMage Product Designer</label>
        <remove name="right"/>
        <remove name="left"/>
        <reference name="root">
            <action method="setTemplate"><template>page/1column.phtml</template></action>
        </reference>
        <reference name="head">
            <action method="addJs"><script>prototype/window.js</script></action>
            <action method="addJs"><script>mage/adminhtml/product.js</script></action>
            <action method="addItem"><type>js_css</type><name>prototype/windows/themes/default.css</name></action>
            <action method="addItem"><type>skin_css</type><name>lib/prototype/windows/themes/magento.css</name></action>
            <action method="addJs"><script>gomage/productdesigner/vendor/fabric.min.js</script></action>
            <action method="addJs"><script>gomage/productdesigner/vendor/excanvas.compiled.js</script></action>
            <action method="addJs"><script>gomage/productdesigner/editor.js</script></action>
            <action method="addItem"><type>skin_css</type><name>css/gomage/productdesigner/editor.css</name><params/></action>
        </reference>
        <reference name="content">
            <block type="designer/editor" name="product_designer_editor" template="gomage/productdesigner/editor.phtml">
                <block type="designer/designer_navigation" name="productNavigator" template="gomage/productdesigner/designer/navigation.phtml">
                    <block type="designer/designer_navigation_filters" name="navigation.filters" template="gomage/productdesigner/designer/navigation/filters.phtml"/>
                    <block type="designer/designer_navigation_product_list" name="productNavigatorList" template="gomage/productdesigner/designer/navigation/list.phtml">
                        <block type="catalog/product_list_toolbar" name="product_navigator_toolbar" template="gomage/productdesigner/designer/navigation/toolbar.phtml">
                            <block type="page/html_pager" name="product_list_toolbar_pager"/>
                        </block>
                        <action method="setToolbarBlockName"><name>product_navigator_toolbar</name></action>
                    </block>
                </block>
                <block type="core/template" name="addDesign" template="gomage/productdesigner/designer/design.phtml">
                    <block type="designer/designer_design_filters" name="design.filters" template="gomage/productdesigner/designer/design/filters.phtml"/>
                    <block type="designer/designer_design_cliparts" name="design.cliparts" template="gomage/productdesigner/designer/design/cliparts.phtml"/>
                </block>
                <block type="designer/designer_text" name="addText" template="gomage/productdesigner/designer/text.phtml" />
                <block type="designer/designer_uploadImage" name="uploadImage" template="gomage/productdesigner/designer/upload_image.phtml">
                    <block type="designer/designer_uploadImage_images" name="uploadedImages" template="gomage/productdesigner/designer/upload_image/images.phtml" />
                </block>
                <!--<block type="designer/designer_ideas" name="designIdeas" template="gomage/productdesigner/designer/design_ideas.phtml" />-->
                <block type="core/template" name="additionalInstructions" template="gomage/productdesigner/designer/additional_instructions.phtml" />
                <block type="core/template" name="customer_form_login" as="customer.login" template="gomage/productdesigner/customer/login.phtml"/>
                <block type="customer/form_register" name="customer_form_register" as="customer.register" template="gomage/productdesigner/customer/register.phtml"/>
            </block>
        </reference>
    </gomage_designer_index_index>

    <gomage_designer_index_filterproducts>
        <reference name="content">
            <block type="designer/designer_navigation" name="productNavigator" template="gomage/productdesigner/designer/navigation.phtml">
                <block type="designer/designer_navigation_filters" name="navigation.filters" template="gomage/productdesigner/designer/navigation/filters.phtml"/>
                <block type="designer/designer_navigation_product_list" name="productNavigatorList" template="gomage/productdesigner/designer/navigation/list.phtml">
                    <block type="catalog/product_list_toolbar" name="product_navigator_toolbar" template="gomage/productdesigner/designer/navigation/toolbar.phtml">
                        <block type="page/html_pager" name="product_list_toolbar_pager"/>
                    </block>
                    <action method="setToolbarBlockName"><name>product_navigator_toolbar</name></action>
                </block>
            </block>
        </reference>
    </gomage_designer_index_filterproducts>

    <gomage_designer_index_filtercliparts>
        <reference name="content">
            <block type="core/template" name="design" template="gomage/productdesigner/designer/design.phtml">
                <block type="designer/designer_design_filters" name="design.filters" template="gomage/productdesigner/designer/design/filters.phtml"/>
                <block type="designer/designer_design_cliparts" name="design.cliparts" template="gomage/productdesigner/designer/design/cliparts.phtml"/>
            </block>
        </reference>
    </gomage_designer_index_filtercliparts>

    <gomage_designer_index_uploadimages translate="label">
        <reference name="content">
            <block type="designer/designer_uploadImage_images" name="uploadedImages" template="gomage/productdesigner/designer/upload_image/images.phtml" />
        </reference>
    </gomage_designer_index_uploadimages>
    <!-- Override templates to add "Customize it" button near "Add to cart button" -->
    <catalog_category_default>
        <reference name="product_list">
            <action method="setTemplate">
                <template>gomage/productdesigner/catalog/product/list.phtml</template>
            </action>
        </reference>
    </catalog_category_default>
    <catalog_category_layered>
        <reference name="product_list">
            <action method="setTemplate">
                <template>gomage/productdesigner/catalog/product/list.phtml</template>
            </action>
        </reference>
    </catalog_category_layered>
    <!-- Top links for logged in customer -->
    <customer_logged_in_top_links>
        <block type="page/template_links" name="top.links" as="topLinks" output="toHtml"/>
        <reference name="top.links">
            <action method="addLink" translate="label title" module="customer"><label>My Account</label><url helper="customer/getAccountUrl"/><title>My Account</title><prepare/><urlParams/><position>10</position></action>
            <action method="addLink" translate="label title" module="customer"><label>Log Out</label><url helper="customer/getLogoutUrl"/><title>Log Out</title><prepare/><urlParams/><position>100</position></action>
            <block type="wishlist/links" name="wishlist_link" />
            <action method="addLinkBlock"><blockName>wishlist_link</blockName></action>
            <block type="checkout/links" name="checkout_cart_link">
                <action method="addCartLink"></action>
                <action method="addCheckoutLink"></action>
            </block>
        </reference>
    </customer_logged_in_top_links>
</layout>